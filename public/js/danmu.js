var socket=io();var canfocus=true;var winWidth,winHeight;function initElementSize(){if(window.innerWidth){winWidth=window.innerWidth}else{if((document.body)&&(document.body.clientWidth)){winWidth=document.body.clientWidth}}if(window.innerHeight){winHeight=window.innerHeight}else{if((document.body)&&(document.body.clientHeight)){winHeight=document.body.clientHeight}}$("#fream").css("height",winHeight);$("#danmuconfig").css("width",winWidth)}function focusOnSlide(){if(canfocus){$("#fream").focus()}setTimeout(focusOnSlide,1500)}$(function(){initElementSize();focusOnSlide();$("#alphabar").change(function(){$("#alphatext").html($(this).val()+"%");$("#danmu").data("opacity",($(this).val())/100)});$(document).mousemove(function(e){if(e.pageY>40){$("#fream").focus();$("#danmuconfig").fadeOut();canfocus=true}else{$("#danmuconfig").fadeIn();canfocus=false}});var a_danmu={"text":"~~~~开启弹幕系统~~~~ ~~开启完成~~ (゜-゜)つロ~  ","color":"green","size":"2","position":"0","time":90};$("#danmu").danmu({left:0,top:20,height:winHeight-20,width:winWidth,zindex:100,speed:30000,sumtime:60*60*10,default_font_color:"#000000",font_size_small:24,font_size_big:32,opacity:"0.9",top_botton_danmu_time:6000});$("#danmu").danmu("danmu_start");$("#danmu").danmu("add_danmu",a_danmu);socket.on("broadcastdanmu",function(msg){console.log("get danmu"+msg);msg["time"]=$("#danmu").data("nowtime");$("#danmu").danmu("add_danmu",msg)});for(var i=0;i<cars.length;i++){$("#danmu").danmu("add_danmu",p1)}});